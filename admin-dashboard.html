<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Admin Dashboard</h1>

  <h2>Add Product</h2>
  <form id="add-product-form">
    <input type="text" name="name" placeholder="Name" required>
    <input type="text" name="category" placeholder="Category" required>
    <input type="number" name="price" placeholder="Price" required>
    <input type="number" name="discount" placeholder="Discount">
    <input type="file" name="image" required>
    <button type="submit">Add Product</button>
  </form>

  <h2>All Products</h2>
  <div id="products-container"></div>

  <script>
    async function fetchProducts() {
      const res = await fetch('http://localhost:3000/products')
      const products = await res.json()
      const container = document.getElementById('products-container')
      container.innerHTML = ''
      products.forEach(p => {
        const div = document.createElement('div')
        div.innerHTML = `
          <h3>${p.name}</h3>
          <p>${p.category}</p>
          <p>â‚¹${p.price} | ${p.discount || 0}% OFF</p>
          <img src="${p.image_url}" width="100">
          <button onclick="deleteProduct(${p.id})">Delete</button>
        `
        container.appendChild(div)
      })
    }

    document.getElementById('add-product-form').addEventListener('submit', async (e) => {
      e.preventDefault()
      const formData = new FormData(e.target)
      await fetch('http://localhost:3000/products', {
        method: 'POST',
        body: formData
      })
      e.target.reset()
      fetchProducts()
    })

    async function deleteProduct(id) {
      await fetch(`http://localhost:3000/products/${id}`, { method: 'DELETE' })
      fetchProducts()
    }

    fetchProducts()
  </script>
</body>
</html>
